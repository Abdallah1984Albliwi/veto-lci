<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>VETO Session</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='50' fill='%230f172a'/><circle cx='50' cy='50' r='30' fill='%238b5cf6'/></svg>"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/lucide@latest"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:'Inter',sans-serif;background:#0a0a0a;color:#fff;height:100vh;overflow:hidden}

/* Top Bar - Fixed */
.top-bar{position:sticky;top:0;z-index:100;background:rgba(10,10,10,0.98);backdrop-filter:blur(20px);border-bottom:1px solid rgba(139,92,246,0.15)}

/* Session Header */
.session-header{padding:1rem 2rem;display:flex;align-items:center;justify-content:space-between;gap:2rem}
.session-meta{display:flex;align-items:center;gap:2rem;flex:1}
.session-title-area{flex:1;max-width:600px}
.session-title-input{width:100%;background:transparent;border:none;color:#e2e8f0;font-size:1.2rem;font-weight:600;padding:0.5rem 0;outline:none;font-family:inherit}
.session-title-input::placeholder{color:#64748b}
.session-title-display{font-size:1.2rem;font-weight:600;color:#e2e8f0}
.session-id-box{display:flex;align-items:center;gap:0.8rem;background:rgba(139,92,246,0.1);padding:0.5rem 1rem;border-radius:8px;border:1px solid rgba(139,92,246,0.2)}
.session-id-label{font-size:0.75rem;color:#94a3b8;font-weight:500;text-transform:uppercase;letter-spacing:0.5px}
.session-id-value{font-family:monospace;font-size:0.9rem;color:#8b5cf6;font-weight:600}
.share-btn{background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.3);color:#8b5cf6;padding:0.5rem 1rem;border-radius:8px;cursor:pointer;display:flex;align-items:center;gap:0.5rem;font-size:0.85rem;font-weight:500;transition:all 0.2s}
.share-btn:hover{background:rgba(139,92,246,0.25);transform:translateY(-1px)}
.header-actions{display:flex;align-items:center;gap:0.8rem}
.action-btn{background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.2);color:#8b5cf6;padding:0.4rem 0.9rem;border-radius:6px;cursor:pointer;font-size:0.8rem;font-weight:500;transition:all 0.2s;display:flex;align-items:center;gap:0.4rem}
.action-btn:hover{background:rgba(139,92,246,0.2)}
.action-btn.danger{background:rgba(239,68,68,0.1);border-color:rgba(239,68,68,0.2);color:#ef4444}
.action-btn.danger:hover{background:rgba(239,68,68,0.2)}
.participants-badge{display:flex;align-items:center;gap:0.5rem;background:rgba(6,182,212,0.1);padding:0.4rem 0.9rem;border-radius:6px;border:1px solid rgba(6,182,212,0.2)}
.participants-badge i{color:#06b6d4}
.participants-count{color:#06b6d4;font-weight:600;font-size:0.9rem}

/* Main Content */
.main-content{height:calc(100vh - 60px);display:grid;grid-template-columns:1fr 1fr;gap:0;overflow:hidden}
.panel{display:flex;flex-direction:column;height:100%;border-right:1px solid rgba(139,92,246,0.1)}
.panel:last-child{border-right:none}
.panel-header{padding:1.2rem 1.5rem;border-bottom:1px solid rgba(139,92,246,0.1);background:rgba(15,15,15,0.6)}
.panel-title{font-size:0.85rem;font-weight:600;color:#94a3b8;text-transform:uppercase;letter-spacing:0.5px;display:flex;align-items:center;gap:0.6rem}
.panel-title i{color:#8b5cf6}
.panel-body{flex:1;display:flex;flex-direction:column;overflow:hidden}
.input-area{flex:1;overflow-y:auto;padding:1.5rem;scroll-behavior:smooth}
.input-area::-webkit-scrollbar{width:4px}
.input-area::-webkit-scrollbar-track{background:transparent}
.input-area::-webkit-scrollbar-thumb{background:rgba(139,92,246,0.3);border-radius:10px}
.input-area::-webkit-scrollbar-thumb:hover{background:rgba(139,92,246,0.5)}
textarea{width:100%;min-height:200px;background:rgba(15,15,15,0.4);border:1px solid rgba(139,92,246,0.15);color:#e2e8f0;padding:1rem;border-radius:8px;font-size:0.95rem;font-family:inherit;resize:none;line-height:1.6;transition:all 0.2s}
textarea:focus{outline:none;border-color:rgba(139,92,246,0.4);background:rgba(15,15,15,0.6)}
textarea::placeholder{color:#475569}
.button-bar{padding:1rem 1.5rem;border-top:1px solid rgba(139,92,246,0.1);background:rgba(10,10,10,0.8)}
.send-btn{width:100%;background:linear-gradient(135deg,#8b5cf6,#6366f1);color:#fff;border:none;padding:0.8rem 1.5rem;border-radius:8px;font-weight:600;font-size:0.9rem;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:0.6rem}
.send-btn:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px rgba(139,92,246,0.4)}
.send-btn:disabled{opacity:0.5;cursor:not-allowed}
.status-text{text-align:center;font-size:0.8rem;color:#64748b;margin-top:0.6rem;min-height:18px}
.output-area{flex:1;overflow-y:auto;padding:1.5rem;scroll-behavior:smooth}
.output-area::-webkit-scrollbar{width:4px}
.output-area::-webkit-scrollbar-track{background:transparent}
.output-area::-webkit-scrollbar-thumb{background:rgba(139,92,246,0.3);border-radius:10px}
.output-area::-webkit-scrollbar-thumb:hover{background:rgba(139,92,246,0.5)}
.collective-display{background:rgba(15,15,15,0.4);border:1px solid rgba(139,92,246,0.1);border-radius:8px;padding:1.5rem;min-height:200px;font-size:0.95rem;line-height:1.8;color:#cbd5e1;white-space:pre-wrap}
.collective-display.empty{display:flex;align-items:center;justify-content:center;color:#475569;font-style:italic;min-height:300px}

/* Toast */
.toast{position:fixed;bottom:2rem;right:2rem;background:rgba(139,92,246,0.95);color:#fff;padding:0.9rem 1.3rem;border-radius:8px;box-shadow:0 8px 24px rgba(0,0,0,0.3);z-index:1000;transform:translateY(100px);opacity:0;transition:all 0.3s;font-size:0.9rem;font-weight:500}
.toast.show{transform:translateY(0);opacity:1}
.toast.success{background:rgba(34,197,94,0.95)}
.toast.error{background:rgba(239,68,68,0.95)}

/* Modal */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.9);z-index:200;display:none;align-items:center;justify-content:center;padding:2rem}
.modal-overlay.show{display:flex}
.modal{background:rgba(15,15,15,0.98);border:1px solid rgba(139,92,246,0.3);border-radius:12px;padding:2rem;max-width:440px;width:100%;box-shadow:0 20px 60px rgba(0,0,0,0.5)}
.modal-icon{text-align:center;margin-bottom:1.2rem}
.modal-icon i{color:#8b5cf6}
.modal h3{color:#e2e8f0;font-size:1.4rem;margin-bottom:0.8rem;font-weight:600;text-align:center}
.modal p{color:#94a3b8;margin-bottom:1.8rem;line-height:1.6;text-align:center;font-size:0.9rem}
.modal-btns{display:flex;flex-direction:column;gap:0.8rem}
.modal-btn{padding:0.8rem;border-radius:8px;font-weight:600;cursor:pointer;border:none;font-size:0.9rem;transition:all 0.2s}
.modal-btn.primary{background:linear-gradient(135deg,#8b5cf6,#6366f1);color:#fff}
.modal-btn.secondary{background:rgba(139,92,246,0.1);color:#8b5cf6;border:1px solid rgba(139,92,246,0.3)}
.modal-btn.danger{background:#ef4444;color:#fff}
.modal-btn:hover{transform:translateY(-1px)}

/* Loading */
.loading-overlay{position:fixed;inset:0;background:rgba(10,10,10,0.98);z-index:300;display:flex;flex-direction:column;align-items:center;justify-content:center}
.spinner{width:48px;height:48px;border:3px solid rgba(139,92,246,0.2);border-top-color:#8b5cf6;border-radius:50%;animation:spin 0.8s linear infinite;margin-bottom:1rem}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{font-size:0.95rem;color:#94a3b8;font-weight:500}

/* Responsive */
@media(max-width:1024px){
.main-content{grid-template-columns:1fr;grid-template-rows:1fr 1fr}
.panel{border-right:none;border-bottom:1px solid rgba(139,92,246,0.1)}
.session-header{flex-direction:column;align-items:stretch;gap:1rem}
.session-meta{flex-direction:column;gap:1rem}
.header-actions{flex-wrap:wrap}
}
</style>
</head>
<body>

<div class="loading-overlay" id="loadingOverlay">
  <div class="spinner"></div>
  <div class="loading-text">Joining session...</div>
</div>

<div class="top-bar">
  <div class="session-header">
    <div class="session-meta">
      <div class="session-title-area">
        <input type="text" class="session-title-input" id="sessionTitleInput" placeholder="Enter session title..." style="display:none">
        <div class="session-title-display" id="sessionTitleDisplay" style="display:none">Session Title</div>
      </div>
      <div class="session-id-box">
        <div>
          <div class="session-id-label">Session</div>
          <div class="session-id-value" id="sessionId">—</div>
        </div>
      </div>
      <button class="share-btn" onclick="shareSession()">
        <i data-lucide="share-2" style="width:16px;height:16px;stroke:currentColor"></i>
        <span>Share</span>
      </button>
    </div>
    <div class="header-actions">
      <div class="participants-badge">
        <i data-lucide="users" style="width:16px;height:16px"></i>
        <span class="participants-count" id="participantCount">0</span>
      </div>
      <button class="action-btn" onclick="toggleLang()" id="langBtn">العربية</button>
      <button class="action-btn" id="logoutBtn" style="display:none" onclick="logout()">Sign Out</button>
      <button class="action-btn danger" onclick="showEndModal()">End</button>
    </div>
  </div>
</div>

<div class="main-content">
  <div class="panel">
    <div class="panel-header">
      <div class="panel-title">
        <i data-lucide="pen-line" style="width:16px;height:16px"></i>
        <span>Your Ideas</span>
      </div>
    </div>
    <div class="panel-body">
      <div class="input-area">
        <textarea id="ideasInput" placeholder="Share your thoughts and ideas here..."></textarea>
      </div>
      <div class="button-bar">
        <button class="send-btn" id="sendBtn" onclick="sendIdea()">
          <i data-lucide="send" style="width:16px;height:16px;stroke:currentColor"></i>
          <span id="sendBtnText">Send to Collective Mind</span>
        </button>
        <div class="status-text" id="status"></div>
      </div>
    </div>
  </div>

  <div class="panel">
    <div class="panel-header">
      <div class="panel-title">
        <i data-lucide="brain-circuit" style="width:16px;height:16px"></i>
        <span>Collective Mind</span>
      </div>
    </div>
    <div class="panel-body">
      <div class="output-area">
        <div class="collective-display empty" id="collectiveMind">
          Waiting for ideas to form collective intelligence...
        </div>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<!-- End Modal -->
<div class="modal-overlay" id="endModal">
  <div class="modal">
    <div class="modal-icon"><i data-lucide="download-cloud" style="width:56px;height:56px"></i></div>
    <h3>End Session?</h3>
    <p>Download the collective mind before ending the session for all participants.</p>
    <div class="modal-btns">
      <button class="modal-btn primary" onclick="downloadAndEnd()">
        Download & End
      </button>
      <button class="modal-btn danger" onclick="confirmEnd()">End Without Saving</button>
      <button class="modal-btn secondary" onclick="closeEndModal()">Cancel</button>
    </div>
  </div>
</div>

<!-- Login Modal -->
<div class="modal-overlay" id="loginModal">
  <div class="modal">
    <div class="modal-icon"><i data-lucide="lock" style="width:56px;height:56px"></i></div>
    <h3>Sign In Required</h3>
    <p>You've used 4 free sessions. Sign in with Google for unlimited access.</p>
    <div class="modal-btns">
      <button class="modal-btn primary" onclick="googleSignIn()" style="display:flex;align-items:center;justify-content:center;gap:0.8rem">
        <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#fff" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#fff" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#fff" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#fff" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
        <span>Continue with Google</span>
      </button>
    </div>
  </div>
</div>

<!-- Logout Modal -->
<div class="modal-overlay" id="logoutModal">
  <div class="modal">
    <div class="modal-icon"><i data-lucide="log-out" style="width:56px;height:56px;stroke:#fb923c"></i></div>
    <h3>Sign Out?</h3>
    <p>You'll be signed out and returned to the home page.</p>
    <div class="modal-btns">
      <button class="modal-btn danger" onclick="confirmLogout()">Sign Out</button>
      <button class="modal-btn secondary" onclick="closeLogoutModal()">Cancel</button>
    </div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>

<script>
const firebaseConfig={apiKey:"AIzaSyAieHsN-E8-NQK8P-SrV9oWIZsBj060vNo",authDomain:"veto-d1412.firebaseapp.com",projectId:"veto-d1412",databaseURL:"https://veto-d1412-default-rtdb.asia-southeast1.firebasedatabase.app"};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();
const auth=firebase.auth();
const WORKER="https://holy-frost-2414.abdallhalbluwi7.workers.dev";

const urlParams=new URLSearchParams(window.location.search);
const sessionId=urlParams.get('id');
let userId=null;
let currentLang='en';
let sessionCount=parseInt(localStorage.getItem('sessionCount')||'0');
let currentUser=localStorage.getItem('vetoUser');
let collectiveMindText='';
let isCreator=false;

if(!sessionId){window.location.href='index.html';}

document.getElementById('sessionId').textContent=sessionId;

setTimeout(()=>document.getElementById('loadingOverlay').style.display='none',2000);

if(!currentUser){
  sessionCount++;
  localStorage.setItem('sessionCount',sessionCount);
  if(sessionCount>4){
    setTimeout(()=>document.getElementById('loginModal').classList.add('show'),3000);
  }
}

auth.onAuthStateChanged(user=>{
  if(user){
    currentUser=user.email;
    localStorage.setItem('vetoUser',user.email);
    document.getElementById('logoutBtn').style.display='block';
  }
});

async function init(){
  try{
    const sessionCheck=await db.ref('sessions/'+sessionId).once('value');
    if(!sessionCheck.exists()){
      isCreator=true;
      await db.ref('sessions/'+sessionId).set({
        created:Date.now(),
        active:true,
        participants:0,
        title:'',
        collectiveMind:''
      });
      document.getElementById('sessionTitleInput').style.display='block';
      document.getElementById('sessionTitleInput').focus();
    }else{
      const title=(await db.ref('sessions/'+sessionId+'/title').once('value')).val();
      if(title){
        document.getElementById('sessionTitleDisplay').textContent=title;
        document.getElementById('sessionTitleDisplay').style.display='block';
      }else{
        document.getElementById('sessionTitleInput').style.display='block';
      }
    }
    
    const userRef=db.ref('sessions/'+sessionId+'/users').push();
    userId=userRef.key;
    await userRef.set({joined:Date.now()});
    await db.ref('sessions/'+sessionId+'/participants').transaction(c=>(c||0)+1);
    
    document.getElementById('loadingOverlay').style.display='none';
  }catch(e){
    console.error(e);
    document.getElementById('loadingOverlay').style.display='none';
  }
}

document.getElementById('sessionTitleInput').addEventListener('blur',async function(){
  const title=this.value.trim();
  if(title){
    await db.ref('sessions/'+sessionId+'/title').set(title);
    document.getElementById('sessionTitleDisplay').textContent=title;
    this.style.display='none';
    document.getElementById('sessionTitleDisplay').style.display='block';
  }
});

db.ref('sessions/'+sessionId+'/participants').on('value',s=>{
  document.getElementById('participantCount').textContent=s.val()||0;
});

db.ref('sessions/'+sessionId+'/title').on('value',s=>{
  const title=s.val();
  if(title&&!isCreator){
    document.getElementById('sessionTitleDisplay').textContent=title;
    document.getElementById('sessionTitleDisplay').style.display='block';
  }
});

db.ref('sessions/'+sessionId+'/collectiveMind').on('value',s=>{
  const mind=s.val();
  const display=document.getElementById('collectiveMind');
  if(mind&&mind.trim()){
    display.classList.remove('empty');
    display.textContent=mind;
    collectiveMindText=mind;
  }
});

function showToast(msg,type='info'){
  const toast=document.getElementById('toast');
  toast.textContent=msg;
  toast.className='toast show '+(type==='success'?'success':type==='error'?'error':'');
  setTimeout(()=>toast.classList.remove('show'),3000);
}

const translations={
  en:{
    writeFirst:'Please write your ideas first',
    sending:'Sending...',
    merging:'Merging into collective mind...',
    merged:'Idea merged successfully',
    failed:'Failed to send',
    linkCopied:'Session link copied to clipboard',
    linkFailed:'Failed to copy link',
    sendBtn:'Send to Collective Mind'
  },
  ar:{
    writeFirst:'يرجى كتابة أفكارك أولاً',
    sending:'جارٍ الإرسال...',
    merging:'جارٍ الدمج في العقل الجماعي...',
    merged:'تم دمج الفكرة بنجاح',
    failed:'فشل الإرسال',
    linkCopied:'تم نسخ رابط الجلسة',
    linkFailed:'فشل نسخ الرابط',
    sendBtn:'إرسال للعقل الجماعي'
  }
};

function shareSession(){
  navigator.clipboard.writeText(window.location.href).then(()=>{
    showToast(translations[currentLang].linkCopied,'success');
  }).catch(()=>{
    showToast(translations[currentLang].linkFailed,'error');
  });
}

async function sendIdea(){
  const input=document.getElementById('ideasInput');
  const idea=input.value.trim();
  if(!idea){showToast(translations[currentLang].writeFirst,'error');return;}
  
  const btn=document.getElementById('sendBtn');
  const status=document.getElementById('status');
  
  btn.disabled=true;
  document.getElementById('sendBtnText').textContent=translations[currentLang].sending;
  status.textContent=translations[currentLang].merging;
  
  try{
    await db.ref('sessions/'+sessionId+'/ideas/'+userId).push({text:idea,timestamp:Date.now()});
    
    const allIdeasSnapshot=await db.ref('sessions/'+sessionId+'/ideas').once('value');
    const allIdeas=[];
    allIdeasSnapshot.forEach(userSnap=>{
      userSnap.forEach(ideaSnap=>{allIdeas.push(ideaSnap.val().text);});
    });
    
    const sessionTitle=document.getElementById('sessionTitleDisplay').textContent||document.getElementById('sessionTitleInput').value||'General Discussion';
    
    const prompt=`You are Collective Mind - an advanced collaborative intelligence system. Analyze these ideas with strategic thinking:

Session Title: "${sessionTitle}"

Ideas:
${allIdeas.map((idea,i)=>`${i+1}. ${idea}`).join('\n')}

Provide ONE unified collective intelligence response (150-300 words):
- Strategic and actionable
- Considers multiple perspectives
- Identifies key patterns
- Resolves contradictions
- Practical recommendations

Write directly and clearly - no separate opinions, just one coherent synthesis.`;
    
    const res=await fetch(WORKER,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({question:allIdeas.join('\n\n'),systemPrompt:prompt})
    });
    
    const data=await res.json();
    const collectiveMind=data.choices?.[0]?.message?.content||'';
    
    await db.ref('sessions/'+sessionId+'/collectiveMind').set(collectiveMind);
    
    input.value='';
    status.textContent=translations[currentLang].merged;
    setTimeout(()=>status.textContent='',3000);
  }catch(e){
    status.textContent=translations[currentLang].failed;
  }finally{
    btn.disabled=false;
    document.getElementById('sendBtnText').textContent=translations[currentLang].sendBtn;
  }
}

function showEndModal(){document.getElementById('endModal').classList.add('show');}
function closeEndModal(){document.getElementById('endModal').classList.remove('show');}

function downloadAndEnd(){
  const text=collectiveMindText||'No collective mind was formed.';
  const blob=new Blob([text],{type:'text/plain'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;
  a.download='VETO-Collective-Mind-'+sessionId+'.txt';
  a.click();
  URL.revokeObjectURL(url);
  setTimeout(confirmEnd,500);
}

function confirmEnd(){
  db.ref('sessions/'+sessionId).update({active:false,ended:Date.now()});
  window.location.href='index.html';
}

function googleSignIn(){
  const provider=new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider).then(result=>{
    currentUser=result.user.email;
    localStorage.setItem('vetoUser',currentUser);
    document.getElementById('loginModal').classList.remove('show');
    showToast('Welcome! Unlimited sessions unlocked','success');
  }).catch(e=>showToast('Sign in failed','error'));
}

function logout(){document.getElementById('logoutModal').classList.add('show');}
function closeLogoutModal(){document.getElementById('logoutModal').classList.remove('show');}
function confirmLogout(){
  auth.signOut();
  localStorage.removeItem('vetoUser');
  window.location.reload();
}

function toggleLang(){
  currentLang=currentLang==='en'?'ar':'en';
  document.documentElement.setAttribute('dir',currentLang==='ar'?'rtl':'ltr');
  document.getElementById('langBtn').textContent=currentLang==='en'?'العربية':'English';
  
  const t={
    en:{
      sessionLabel:'Session',
      shareBtn:'Share',
      participantsLabel:'participants',
      logoutBtn:'Sign Out',
      endBtn:'End',
      yourIdeas:'Your Ideas',
      collectiveMind:'Collective Mind',
      ideasPlaceholder:'Share your thoughts and ideas here...',
      sendBtn:'Send to Collective Mind',
      emptyText:'Waiting for ideas to form collective intelligence...',
      titlePlaceholder:'Enter session title...',
      sending:'Sending...',
      merging:'Merging into collective mind...',
      merged:'Idea merged successfully',
      failed:'Failed to send',
      writeFirst:'Please write your ideas first',
      linkCopied:'Session link copied to clipboard',
      linkFailed:'Failed to copy link'
    },
    ar:{
      sessionLabel:'الجلسة',
      shareBtn:'مشاركة',
      participantsLabel:'مشاركون',
      logoutBtn:'تسجيل خروج',
      endBtn:'إنهاء',
      yourIdeas:'أفكارك',
      collectiveMind:'العقل الجماعي',
      ideasPlaceholder:'شارك أفكارك هنا...',
      sendBtn:'إرسال للعقل الجماعي',
      emptyText:'في انتظار الأفكار لتشكيل الذكاء الجماعي...',
      titlePlaceholder:'أدخل عنوان الجلسة...',
      sending:'جارٍ الإرسال...',
      merging:'جارٍ الدمج في العقل الجماعي...',
      merged:'تم دمج الفكرة بنجاح',
      failed:'فشل الإرسال',
      writeFirst:'يرجى كتابة أفكارك أولاً',
      linkCopied:'تم نسخ رابط الجلسة',
      linkFailed:'فشل نسخ الرابط'
    }
  };
  
  const text=t[currentLang];
  
  document.querySelector('.session-id-label').textContent=text.sessionLabel;
  document.querySelector('.share-btn span').textContent=text.shareBtn;
  document.getElementById('logoutBtn').textContent=text.logoutBtn;
  document.querySelector('.action-btn.danger').textContent=text.endBtn;
  document.querySelector('.panel:first-child .panel-title span').textContent=text.yourIdeas;
  document.querySelector('.panel:last-child .panel-title span').textContent=text.collectiveMind;
  document.getElementById('ideasInput').placeholder=text.ideasPlaceholder;
  document.getElementById('sendBtnText').textContent=text.sendBtn;
  const emptyDisplay=document.querySelector('.collective-display.empty');
  if(emptyDisplay)emptyDisplay.textContent=text.emptyText;
  document.getElementById('sessionTitleInput').placeholder=text.titlePlaceholder;
}

init();
lucide.createIcons();
</script>

</body>
</html>
